<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Starlight: Rida</title>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,600&family=Montserrat:wght@200;300;400&display=swap" rel="stylesheet">
    <style>
        :root {
            /* VELVET COSMOS PALETTE */
            --bg-deep: #050508;
            --glass-panel: rgba(20, 20, 25, 0.6);
            --border-soft: rgba(255, 255, 255, 0.08);
            --gold-dim: #8a7e68;
            --gold-bright: #d4af37;
            --starlight: #e2e2e2;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; }

        body {
            background-color: var(--bg-deep);
            color: var(--starlight);
            font-family: 'Montserrat', sans-serif;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            perspective: 1000px;
        }

        /* --- BACKGROUND ATMOSPHERE --- */
        .ambient-glow {
            position: absolute;
            width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 120%, #1a1025, #000 60%);
            z-index: -2;
        }
        
        .drifting-stars {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background-image: 
                radial-gradient(1px 1px at 50px 50px, #fff, transparent),
                radial-gradient(1px 1px at 100px 150px, #fff, transparent),
                radial-gradient(1px 1px at 200px 50px, #fff, transparent);
            background-size: 300px 300px;
            opacity: 0.3;
            animation: drift 100s linear infinite;
            z-index: -1;
        }

        /* --- THE LOCK SCREEN (ELEGANT CANVAS) --- */
        #lock-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 100;
            background: rgba(5, 5, 8, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 1.5s ease;
        }
        
        .lock-instruction {
            margin-top: 300px;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.2rem;
            color: var(--gold-dim);
            letter-spacing: 2px;
            opacity: 0;
            animation: fadeInSlow 3s forwards 1s;
        }

        /* --- FOG GAME LAYER --- */
        #fog-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 50;
            display: none; /* Active later */
            cursor: pointer;
        }

        /* --- MAIN UI CARD --- */
        .card-container {
            width: 100%;
            max-width: 480px;
            position: relative;
            z-index: 10;
            opacity: 0;
            transform: translateY(20px);
            transition: all 1s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        .glass-card {
            background: var(--glass-panel);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid var(--border-soft);
            border-radius: 4px; /* Slightly sharper corners for elegance */
            padding: 50px 40px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            min-height: 550px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* --- TYPOGRAPHY --- */
        h1 {
            font-family: 'Cormorant Garamond', serif;
            font-size: 2.8rem;
            font-weight: 400;
            color: var(--starlight);
            margin-bottom: 10px;
            letter-spacing: -0.5px;
            text-align: center;
        }

        .subtitle {
            text-align: center;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--gold-dim);
            margin-bottom: 40px;
        }

        /* --- ELEGANT BUTTONS --- */
        .choice-btn {
            display: flex;
            align-items: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            cursor: pointer;
            transition: all 0.4s ease;
            color: #888;
        }

        .choice-btn:hover {
            padding-left: 10px;
            color: #fff;
            border-bottom-color: var(--gold-dim);
        }

        .choice-btn:last-child { border-bottom: none; }

        .btn-icon { font-size: 1.2rem; margin-right: 20px; opacity: 0.7; }
        .btn-label { font-family: 'Cormorant Garamond', serif; font-size: 1.4rem; }
        .btn-sub { display: none; } /* Keeping it ultra clean */

        /* --- INPUTS --- */
        input[type="text"] {
            width: 100%;
            background: transparent;
            border: none;
            border-bottom: 1px solid #333;
            padding: 15px 0;
            color: #fff;
            font-family: 'Cormorant Garamond';
            font-size: 1.5rem;
            outline: none;
            text-align: center;
            margin-bottom: 30px;
            transition: border-color 0.5s;
        }
        input[type="text"]:focus { border-bottom-color: var(--gold-bright); }
        input[type="text"]::placeholder { color: #333; font-style: italic; }

        .finish-btn {
            background: transparent;
            border: 1px solid var(--gold-dim);
            color: var(--gold-dim);
            padding: 15px 40px;
            font-family: 'Montserrat';
            font-size: 0.8rem;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin: 0 auto;
            display: block;
            cursor: pointer;
            transition: 0.5s;
        }
        .finish-btn:hover {
            border-color: var(--gold-bright);
            color: var(--gold-bright);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.1);
        }

        /* --- ANIMATIONS --- */
        @keyframes drift { from { background-position: 0 0; } to { background-position: 0 1000px; } }
        @keyframes fadeInSlow { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* HIDDEN FORM */
        #hidden-form { display: none; }
        
        /* REPORT */
        #report-view { display: none; text-align: center; }
        .r-line { margin-bottom: 20px; }
        .r-lbl { font-size: 0.6rem; color: var(--gold-dim); letter-spacing: 2px; text-transform: uppercase; }
        .r-val { font-family: 'Cormorant Garamond'; font-size: 1.8rem; color: #fff; margin-top: 5px; }

        /* WARP EFFECT (Subtle) */
        .warp-speed {
            position: fixed; top: 50%; left: 50%; width: 2px; height: 2px;
            z-index: 200; pointer-events: none; opacity: 0;
            box-shadow: 0 0 50px #fff;
            transition: all 2s ease-in;
        }
        body.launching .warp-speed {
            width: 100vw; height: 2px;
            opacity: 1;
            box-shadow: 0 0 100px #fff, 0 0 200px var(--gold-bright);
            background: #fff;
        }

    </style>
</head>
<body>

    <div class="ambient-glow"></div>
    <div class="drifting-stars"></div>
    
    <div class="warp-speed"></div>

    <div id="lock-layer">
        <canvas id="constellation"></canvas>
        <div class="lock-instruction">Connect the stars</div>
    </div>

    <canvas id="fog-layer"></canvas>

    <div class="card-container" id="main-ui">
        <div class="glass-card">
            
            <div class="step" id="step-1">
                <h1>Shuro Hojaye?</h1>
                <p class="subtitle">Phase I: The Fuel</p>
                
                <div class="choice-btn" onclick="next(2, 'caffeine', 'Black')">
                    <span class="btn-icon">üåë</span> <span class="btn-label">Pitch Black</span>
                </div>
                <div class="choice-btn" onclick="next(2, 'caffeine', 'Sweet')">
                    <span class="btn-icon">‚ú®</span> <span class="btn-label">Sweet & Iced</span>
                </div>
                <div class="choice-btn" onclick="next(2, 'caffeine', 'Tea')">
                    <span class="btn-icon">üçµ</span> <span class="btn-label">Tea / Decaf</span>
                </div>
            </div>

            <div class="step" id="step-2" style="display:none;">
                <h1>Coordinates</h1>
                <p class="subtitle">Phase II: The Setting</p>
                
                <div class="choice-btn" onclick="next(3, 'venue', 'Cote Rotie')">
                    <span class="btn-icon">üïØÔ∏è</span> <span class="btn-label">Cote R√¥tie</span>
                </div>
                <div class="choice-btn" onclick="next(3, 'venue', 'Xanders')">
                    <span class="btn-icon">ü•Ç</span> <span class="btn-label">Xander's</span>
                </div>
                <div class="choice-btn" onclick="next(3, 'venue', 'Koel')">
                    <span class="btn-icon">üåø</span> <span class="btn-label">Koel Cafe</span>
                </div>
                <div class="choice-btn" onclick="next(3, 'venue', 'Surprise')">
                    <span class="btn-icon">üóùÔ∏è</span> <span class="btn-label">Surprise Me</span>
                </div>
            </div>

            <div class="step" id="step-3" style="display:none;">
                <h1>Interlude</h1>
                <p class="subtitle">Phase III: A Small Game</p>
                
                <div class="choice-btn" onclick="next(4, 'game', 'Mind Meld')">
                    <span class="btn-icon">üß†</span> <span class="btn-label">Mind Meld</span>
                </div>
                <div class="choice-btn" onclick="next(4, 'game', 'Strawberry Test')">
                    <span class="btn-icon">üçì</span> <span class="btn-label">Strawberry Test</span>
                </div>
                <div class="choice-btn" onclick="next(4, 'game', '20 Questions')">
                    <span class="btn-icon">‚ùì</span> <span class="btn-label">20 Questions</span>
                </div>
            </div>

            <div class="step" id="step-4" style="display:none;">
                <h1>Alignment</h1>
                <p class="subtitle">Final Calibration</p>
                
                <input type="text" id="input-ick" placeholder="What is your biggest Ick?">
                <input type="text" id="input-rule" placeholder="One golden rule?">
                
                <button class="finish-btn" onclick="finish()">Confirm Date</button>
            </div>

            <div id="report-view">
                <h1 style="font-size:3.5rem; margin-bottom: 40px;">It's a Date.</h1>
                
                <div class="r-line">
                    <div class="r-lbl">Location</div>
                    <div class="r-val" id="res-venue"></div>
                </div>
                <div class="r-line">
                    <div class="r-lbl">Activity</div>
                    <div class="r-val" id="res-game"></div>
                </div>
                
                <div style="margin-top: 50px; font-size: 0.7rem; color: #555; letter-spacing: 1px;">
                    TRANSMISSION RECEIVED
                </div>
            </div>

        </div>
    </div>

    <form id="hidden-form" action="https://formspree.io/f/xgozggkq" method="POST">
        <input type="hidden" name="caffeine" id="form-caffeine">
        <input type="hidden" name="venue" id="form-venue">
        <input type="hidden" name="game" id="form-game">
        <input type="hidden" name="ick" id="form-ick">
        <input type="hidden" name="rule" id="form-rule">
    </form>

    <script>
        // --- 1. CONSTELLATION LOCK ---
        const cCanvas = document.getElementById('constellation');
        const cCtx = cCanvas.getContext('2d');
        const lockLayer = document.getElementById('lock-layer');
        const mainUi = document.getElementById('main-ui');
        
        cCanvas.width = window.innerWidth;
        cCanvas.height = window.innerHeight;

        // Elegant, thin lines. Golden hue.
        const stars = [
            {x: window.innerWidth/2, y: window.innerHeight/2 - 120, active: false},
            {x: window.innerWidth/2 - 80, y: window.innerHeight/2, active: false},
            {x: window.innerWidth/2 + 80, y: window.innerHeight/2, active: false},
            {x: window.innerWidth/2, y: window.innerHeight/2 + 120, active: false}
        ];

        let isDrawing = false;

        function drawLock() {
            cCtx.clearRect(0,0,cCanvas.width, cCanvas.height);
            
            // Draw connections
            cCtx.beginPath();
            cCtx.strokeStyle = 'rgba(212, 175, 55, 0.4)'; // Gold
            cCtx.lineWidth = 1;
            
            const active = stars.filter(s => s.active);
            if(active.length > 0) {
                cCtx.moveTo(active[0].x, active[0].y);
                for(let i=1; i<active.length; i++) cCtx.lineTo(active[i].x, active[i].y);
            }
            cCtx.stroke();

            // Draw Stars
            stars.forEach(s => {
                cCtx.beginPath();
                cCtx.fillStyle = s.active ? '#d4af37' : '#555';
                cCtx.arc(s.x, s.y, 4, 0, Math.PI*2);
                cCtx.fill();
                
                // Glow
                if(s.active) {
                    cCtx.shadowBlur = 15;
                    cCtx.shadowColor = '#d4af37';
                } else {
                    cCtx.shadowBlur = 0;
                }
            });
        }

        function checkLock(x,y) {
            stars.forEach(s => {
                if(Math.hypot(s.x - x, s.y - y) < 40) s.active = true;
            });
            drawLock();
            if(stars.every(s => s.active)) unlock();
        }

        cCanvas.addEventListener('mousedown', () => isDrawing = true);
        cCanvas.addEventListener('mousemove', (e) => { if(isDrawing) checkLock(e.clientX, e.clientY); });
        cCanvas.addEventListener('mouseup', () => isDrawing = false);
        cCanvas.addEventListener('touchstart', () => isDrawing = true);
        cCanvas.addEventListener('touchmove', (e) => { checkLock(e.touches[0].clientX, e.touches[0].clientY); });

        drawLock();

        function unlock() {
            lockLayer.style.opacity = '0';
            setTimeout(() => {
                lockLayer.style.display = 'none';
                mainUi.style.opacity = '1';
                mainUi.style.transform = 'translateY(0)';
            }, 1000);
        }


        // --- 2. FOG GAME (Interlude) ---
        // This runs between Step 1 and 2
        const fCanvas = document.getElementById('fog-layer');
        const fCtx = fCanvas.getContext('2d');
        let fogActive = false;

        fCanvas.width = window.innerWidth;
        fCanvas.height = window.innerHeight;

        function initFog() {
            fogActive = true;
            fCanvas.style.display = 'block';
            mainUi.style.opacity = '0'; // Hide UI momentarily
            
            // Fill with elegant dark fog
            fCtx.fillStyle = 'rgba(10, 10, 15, 0.98)';
            fCtx.fillRect(0, 0, fCanvas.width, fCanvas.height);
            
            // Text instruction
            fCtx.fillStyle = '#8a7e68';
            fCtx.font = '20px Montserrat';
            fCtx.textAlign = 'center';
            fCtx.fillText("Clear the mist to proceed...", fCanvas.width/2, fCanvas.height/2);
            
            fCtx.globalCompositeOperation = 'destination-out';
        }

        function clearFog(x, y) {
            if(!fogActive) return;
            fCtx.beginPath();
            fCtx.arc(x, y, 60, 0, Math.PI*2); // Brush size
            fCtx.fill();
            
            // Check if enough cleared (simple timer hack for smoothness)
        }
        
        // Simple counter to finish fog game
        let clearCount = 0;
        function trackClear() {
            clearCount++;
            if(clearCount > 100) endFog(); // approx 2 seconds of movement
        }

        fCanvas.addEventListener('mousemove', (e) => { clearFog(e.clientX, e.clientY); trackClear(); });
        fCanvas.addEventListener('touchmove', (e) => { clearFog(e.touches[0].clientX, e.touches[0].clientY); trackClear(); });

        function endFog() {
            fogActive = false;
            fCanvas.style.transition = 'opacity 1s';
            fCanvas.style.opacity = '0';
            setTimeout(() => {
                fCanvas.style.display = 'none';
                mainUi.style.opacity = '1';
                document.getElementById('step-1').style.display = 'none';
                document.getElementById('step-2').style.display = 'block';
            }, 1000);
        }


        // --- 3. FORM NAVIGATION ---
        const data = {};

        function next(step, key, val) {
            data[key] = val;
            document.getElementById('form-'+key).value = val;

            if(step === 2) {
                // Trigger Fog Game instead of direct transition
                initFog();
            } else {
                // Standard fade
                const curr = document.getElementById('step-' + (step-1));
                const nxt = document.getElementById('step-' + step);
                
                curr.style.display = 'none';
                nxt.style.opacity = '0';
                nxt.style.display = 'block';
                
                // Slight delay for fade in
                setTimeout(() => nxt.style.opacity = '1', 50);
            }
        }

        function finish() {
            data.ick = document.getElementById('input-ick').value;
            data.rule = document.getElementById('input-rule').value;
            document.getElementById('form-ick').value = data.ick;
            document.getElementById('form-rule').value = data.rule;

            // Submit
            const form = document.getElementById('hidden-form');
            const formData = new FormData(form);
            fetch(form.action, { method: 'POST', body: formData, headers: {'Accept': 'application/json'} });

            // Show Report
            document.getElementById('step-4').style.display = 'none';
            document.getElementById('report-view').style.display = 'block';
            
            document.getElementById('res-venue').innerText = data.venue;
            document.getElementById('res-game').innerText = data.game;

            // ADRENALINE KICK (Warp Launch)
            setTimeout(() => {
                document.body.classList.add('launching');
            }, 500);
        }

    </script>
</body>
</html>
